<!DOCTYPE html>
<html>
<head>
  <title>Edit College Profile</title>
</head>
<body>

<h2>Edit College Profile</h2>

<form id="editProfileForm">
  <label>College Name</label><br />
  <input type="text" id="name" required />
  <br /><br />

  <h4>Placement Officer</h4>

  <label>Name</label><br />
  <input type="text" id="poName" required />
  <br /><br />

  <label>Email</label><br />
  <input type="email" id="poEmail" required />
  <br /><br />

  <label>Mobile</label><br />
  <input type="text" id="poMobile" required />
  <br /><br />

  <button type="submit">Update Profile</button>
</form>

<p id="msg"></p>

<a href="/college/profile">Back</a>

<script>
  // Load existing profile
  async function loadProfile() {
    const res = await fetch("/api/colleges/profile", {
      credentials: "include"
    });
    const data = await res.json();

    if (data.success) {
      document.getElementById("name").value = data.profile.name;
      document.getElementById("poName").value = data.profile.placementOfficer.name;
      document.getElementById("poEmail").value = data.profile.placementOfficer.email;
      document.getElementById("poMobile").value = data.profile.placementOfficer.mobile;
    }
  }

  loadProfile();

  // Submit update
  document.getElementById("editProfileForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const payload = {
      name: document.getElementById("name").value,
      placementOfficer: {
        name: document.getElementById("poName").value,
        email: document.getElementById("poEmail").value,
        mobile: document.getElementById("poMobile").value
      }
    };

    const res = await fetch("/api/colleges/profile/update", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      credentials: "include",
      body: JSON.stringify(payload)
    });

    const data = await res.json();
    document.getElementById("msg").innerText = data.message;

    if (data.success) {
      setTimeout(() => {
        window.location.href = "/college/profile";
      }, 1000);
    }
  });
</script>

</body>
</html>
